<article class="profile-container">
    <h1 class="profile">{{#if isOwnProfile}}Hi, {{user.firstName}}!{{else}}{{user.firstName}}'s Profile{{/if}}</h1>

    <!-- Profile Information Container -->
    <section class = "profSection">
    <section class="profile-info">
        <p class = "profileInfo">Username: {{user.username}}</p>
        <p class = "profileInfo">First Name: {{user.firstName}}</p>
        <p class = "profileInfo">Last Name: {{user.lastName}}</p>
        {{#if isOwnProfile}}
        {{else}}
            <form action="/profile/follow" method="POST" class="followForm" id="follow-form">
                <input type="hidden" id="follow-friendId" name="friendId" value="{{user._id}}">
                <input type="hidden" id="follow-userId" name="userId" value="{{currUser._id}}">
                <input type="hidden" name="action" value="{{#if isFollowing}}unfollow{{else}}follow{{/if}}">
                <button type="submit" class="followButton">{{#if isFollowing}}Unfollow{{else}}Follow{{/if}}</button>
            </form>
        {{/if}}
        {{#if message}}
        <p class="deletedReview">{{message}}</p>
        {{/if}}
    </section>
    </section>
    
    <!-- "Following" Container -->
    <section class = "profSection">
    <section class="profile-following">
        <h2 class = "profile">Following:</h2>
        <ul>
            <!-- Display each user this user is following -->
            {{#each user.following}}
                <li>
                    <a href="/profile/{{this._id}}">Username: {{this.username}}</a>
                </li>
            {{/each}}
        </ul>
    </section>
    </section>

    <!-- "My Followers" Container -->
    <section class = "profSection">
    <section class="profile-followers">
        <h2 class = "profile">Followers:</h2>
        <ul>
            <!-- Display each user who is following this user -->
            {{#each user.followers}}
                <li>
                    <a href="/profile/{{this._id}}">Username: {{this.username}}</a>
                </li>
            {{/each}}
        </ul>
    </section>
    </section>
<!-- PERSONAL COMMENT:
ALL RSVP FIELDS:
    comment: comment,
    meetUpTime: meetUpTime,
    restaurantId: restaurantId,
    userId: userId,
    usersAttending: [userId]
-->


    <!-- "My RSVP Posts" Container -->
    <!-- <a href="/rsvp/{{this._id}}">{{this.title}} - {{this.meetUpTime.date}}, {{this.meetUpTime.time}}</a> -->
    <section class = "profSection">
    <section class="profile-rsvps">
        <h2 class = "profile">Meetup Posts:</h2>
        <p class="rinfo">all posted and attended meetups</p>
        <ul>
            <!-- Display all RSVP posts made by this user -->
            {{#each user.RSVPposts}}
                <li class = "rsvpli">
                    <div class = "profRsvp">
                        <details><summary class = "caret-summary"><p> <span class="caret"></span>Posted By: {{this.user}} </p></summary>
                        <p>When: {{this.meetUpTime.Date}}, {{this.meetUpTime.Time}}</p>
                        <p>Where: {{this.restaurantId}}</p>
                        <p>Comment: {{this.comment}}</p>
                        <p>Users Attending: {{this.usersAttending}}</p>
                        </details>
                    </div>
                </li>
            {{/each}}
        </ul>
    </section>
    </section>

    <!-- "My Current RSVPs" Container -->
    <!-- <a href="/rsvp/{{this._id}}">{{this.title}} - {{this.date}}, {{this.time}}</a> -->
    <section class = "profSection">
    <section class="profile-myRSVPposts">
        <h2 class = "profile">Active Meetup Posts and RSVPs:</h2>
        <p class="rinfo">current meetups posted by me, or meetups that I am attending</p>
        <ul>
            <!-- Display all current RSVP posts made by this user -->
            {{#each user.currentRSVPs}}
                <li class = "rsvpli">
                    <div class = "profRsvp">
                        <details><summary class = "caret-summary"><p> <span class="caret"></span>Posted By: {{this.user}} </p></summary>
                        <p>When: {{this.meetUpTime.Date}}, {{this.meetUpTime.Time}}</p>
                        <p>Where: {{this.restaurantId}}</p>
                        <p>Comment: {{this.comment}}</p>
                        <p>Users Attending: {{this.usersAttending}}</p>
                        </details>
                    </div>
                </li>
            {{/each}}
        </ul>
    </section>
    </section>
    <!-- "Reviews" Container -->
    <section class="profSection">
    <section class="profile-myReviews">
       <h2 class = "profile">Reviews:</h2>
       <details open><summary class = "caret-summary"><p> <span class="caret"></span> All Reviews </p></summary>
        <ul>
            {{#each user.reviews}}
                <li class="reviewLi">
                    {{#if ../isOwnProfile}}
                    <form>
                        <button type="submit" class="EditandDeleteButton">Edit</button>
                    </form>
                    <form action="/profile/delete" method="POST" class="deleteReveiwForm">
                        <input type="hidden" name="reviewId" value="{{this._id}}">
                        <input type="hidden" name="userId" value="{{this.userId}}">
                        <button type="submit" class="EditandDeleteButton">Delete</button>
                    </form>
                    <div id="delete-error" class="meetupError" hidden></div>
                    {{/if}}
                    <div class="reviewInfo">
                        {{#if this.menuItemName}}
                            <p><span class="reviewSpan">{{this.restaurantName}}:</span> <span class="revItalic">{{this.menuItemName}}</span></p>
                        {{else}}
                            <p><span class="reviewSpan">{{this.restaurantName}}</span></p>
                        {{/if}}
                        <p><span class="reviewSpan">Rating:</span> {{this.rating}}</p>
                        <p><span class="reviewSpan">Wait Time:</span> {{this.waitTime}}</p>
                        <p><span class="reviewSpan">Review:</span> {{this.review}}</p>
                    </div>
                </li>
            {{/each}}
        </ul>
        </details> 
    </section>
    </section>
</article>

<script src="/js/formValidation.js"></script>
</body>
</html>
